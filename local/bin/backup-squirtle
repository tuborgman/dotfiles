#!/bin/sh

DEST="b2:squirtle-backup"
DIRS=(
  "/mnt/external"
  "/home"
  "/etc"
  "/opt"
  "/usr"
  "/var"
)

sync_dir() {
  local dir="$1"
  local full_dir=$(realpath "$dir")

  rclone sync "$dir" "$DEST""$full_dir" \
    --transfers 8 \
    --bwlimit "01:00,off 08:00,1.5M" # limit bandwidth to 1.5mb/s from 8am - 1am
    --verbose
}

for dir in "${DIRS[@]}"
do
  sync_dir "$dir"
done
